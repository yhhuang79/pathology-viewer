(this["webpackJsonppathology-viewer"]=this["webpackJsonppathology-viewer"]||[]).push([[0],{41:function(t,e,a){var i,n;i=this,n=function(){var t={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},e=function(){var e=function(t){this._coordinator={},this._data=[],this._radi=[],this._min=10,this._max=1,this._xField=t.xField||t.defaultXField,this._yField=t.yField||t.defaultYField,this._valueField=t.valueField||t.defaultValueField,t.radius&&(this._cfgRadius=t.radius)},a=t.defaultRadius;return e.prototype={_organiseData:function(t,e){var i=t[this._xField],n=t[this._yField],r=this._radi,s=this._data,o=this._max,h=this._min,l=t[this._valueField]||1,d=t.radius||this._cfgRadius||a;s[i]||(s[i]=[],r[i]=[]),s[i][n]?s[i][n]+=l:(s[i][n]=l,r[i][n]=d);var c=s[i][n];return c>o?(e?this.setDataMax(c):this._max=c,!1):c<h?(e?this.setDataMin(c):this._min=c,!1):{x:i,y:n,value:l,radius:d,min:h,max:o}},_unOrganizeData:function(){var t=[],e=this._data,a=this._radi;for(var i in e)for(var n in e[i])t.push({x:i,y:n,radius:a[i][n],value:e[i][n]});return{min:this._min,max:this._max,data:t}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0)for(var t=arguments[0],e=t.length;e--;)this.addData.call(this,t[e]);else{var a=this._organiseData(arguments[0],!0);a&&(0===this._data.length&&(this._min=this._max=a.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[a]}))}return this},setData:function(t){var e=t.data,a=e.length;this._data=[],this._radi=[];for(var i=0;i<a;i++)this._organiseData(e[i],!1);return this._max=t.max,this._min=t.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(t){return this._max=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(t){return this._min=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(t){this._coordinator=t},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},e}(),a=function(){var t=function(t){var e=t.gradient||t.defaultGradient,a=document.createElement("canvas"),i=a.getContext("2d");a.width=256,a.height=1;var n=i.createLinearGradient(0,0,256,1);for(var r in e)n.addColorStop(r,e[r]);return i.fillStyle=n,i.fillRect(0,0,256,1),i.getImageData(0,0,256,1).data},e=function(t,e){var a=document.createElement("canvas"),i=a.getContext("2d"),n=t,r=t;if(a.width=a.height=2*t,1==e)i.beginPath(),i.arc(n,r,t,0,2*Math.PI,!1),i.fillStyle="rgba(0,0,0,1)",i.fill();else{var s=i.createRadialGradient(n,r,t*e,n,r,t);s.addColorStop(0,"rgba(0,0,0,1)"),s.addColorStop(1,"rgba(0,0,0,0)"),i.fillStyle=s,i.fillRect(0,0,2*t,2*t)}return a};function a(e){var a=e.container,i=this.shadowCanvas=document.createElement("canvas"),n=this.canvas=e.canvas||document.createElement("canvas"),r=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(e.container)||{});n.className="heatmap-canvas",this._width=n.width=i.width=e.width||+r.width.replace(/px/,""),this._height=n.height=i.height=e.height||+r.height.replace(/px/,""),this.shadowCtx=i.getContext("2d"),this.ctx=n.getContext("2d"),n.style.cssText=i.style.cssText="position:absolute;left:0;top:0;",a.style.position="relative",a.appendChild(n),this._palette=t(e),this._templates={},this._setStyles(e)}return a.prototype={renderPartial:function(t){t.data.length>0&&(this._drawAlpha(t),this._colorize())},renderAll:function(t){this._clear(),t.data.length>0&&(this._drawAlpha(function(t){for(var e=[],a=t.min,i=t.max,n=t.radi,r=(t=t.data,Object.keys(t)),s=r.length;s--;)for(var o=r[s],h=Object.keys(t[o]),l=h.length;l--;){var d=h[l],c=t[o][d],u=n[o][d];e.push({x:o,y:d,value:c,radius:u})}return{min:a,max:i,data:e}}(t)),this._colorize())},_updateGradient:function(e){this._palette=t(e)},updateConfig:function(t){t.gradient&&this._updateGradient(t),this._setStyles(t)},setDimensions:function(t,e){this._width=t,this._height=e,this.canvas.width=this.shadowCanvas.width=t,this.canvas.height=this.shadowCanvas.height=e},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(t){this._blur=0==t.blur?0:t.blur||t.defaultBlur,t.backgroundColor&&(this.canvas.style.backgroundColor=t.backgroundColor),this._width=this.canvas.width=this.shadowCanvas.width=t.width||this._width,this._height=this.canvas.height=this.shadowCanvas.height=t.height||this._height,this._opacity=255*(t.opacity||0),this._maxOpacity=255*(t.maxOpacity||t.defaultMaxOpacity),this._minOpacity=255*(t.minOpacity||t.defaultMinOpacity),this._useGradientOpacity=!!t.useGradientOpacity},_drawAlpha:function(t){for(var a=this._min=t.min,i=this._max=t.max,n=(t=t.data||[]).length,r=1-this._blur;n--;){var s,o=t[n],h=o.x,l=o.y,d=o.radius,c=Math.min(o.value,i),u=h-d,m=l-d,_=this.shadowCtx;this._templates[d]?s=this._templates[d]:this._templates[d]=s=e(d,r);var g=(c-a)/(i-a);_.globalAlpha=g<.01?.01:g,0!==s.height&&0!==s.width&&_.drawImage(s,u,m),u<this._renderBoundaries[0]&&(this._renderBoundaries[0]=u),m<this._renderBoundaries[1]&&(this._renderBoundaries[1]=m),u+2*d>this._renderBoundaries[2]&&(this._renderBoundaries[2]=u+2*d),m+2*d>this._renderBoundaries[3]&&(this._renderBoundaries[3]=m+2*d)}},_colorize:function(){var t=this._renderBoundaries[0],e=this._renderBoundaries[1],a=this._renderBoundaries[2]-t,i=this._renderBoundaries[3]-e,n=this._width,r=this._height,s=this._opacity,o=this._maxOpacity,h=this._minOpacity,l=this._useGradientOpacity;t<0&&(t=0),e<0&&(e=0),t+a>n&&(a=n-t),e+i>r&&(i=r-e);for(var d=this.shadowCtx.getImageData(t,e,a,i),c=d.data,u=c.length,m=this._palette,_=3;_<u;_+=4){var g,f=c[_],p=4*f;p&&(g=s>0?s:f<o?f<h?h:f:o,c[_-3]=m[p],c[_-2]=m[p+1],c[_-1]=m[p+2],c[_]=l?m[p+3]:g)}d.data=c,this.ctx.putImageData(d,t,e),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(t){var e=this.shadowCtx.getImageData(t.x,t.y,1,1).data[3],a=this._max,i=this._min;return Math.abs(a-i)*(e/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},a}(),i=function(){var e=!1;return"canvas2d"===t.defaultRenderer&&(e=a),e}(),n=function(){for(var t={},e=arguments.length,a=0;a<e;a++){var i=arguments[a];for(var n in i)t[n]=i[n]}return t},r=function(){var a=function(){function t(){this.cStore={}}return t.prototype={on:function(t,e,a){var i=this.cStore;i[t]||(i[t]=[]),i[t].push((function(t){return e.call(a,t)}))},emit:function(t,e){var a=this.cStore;if(a[t])for(var i=a[t].length,n=0;n<i;n++)(0,a[t][n])(e)}},t}(),r=function(t){var e=t._renderer,a=t._coordinator,i=t._store;a.on("renderpartial",e.renderPartial,e),a.on("renderall",e.renderAll,e),a.on("extremachange",(function(e){t._config.onExtremaChange&&t._config.onExtremaChange({min:e.min,max:e.max,gradient:t._config.gradient||t._config.defaultGradient})})),i.setCoordinator(a)};function s(){var s=this._config=n(t,arguments[0]||{});if(this._coordinator=new a,s.plugin){var o=s.plugin;if(!t.plugins[o])throw new Error("Plugin '"+o+"' not found. Maybe it was not registered.");var h=t.plugins[o];this._renderer=new h.renderer(s),this._store=new h.store(s)}else this._renderer=new i(s),this._store=new e(s);r(this)}return s.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(t){return this._config=n(this._config,t),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(t){return this._store.getValueAt?this._store.getValueAt(t):this._renderer.getValueAt?this._renderer.getValueAt(t):null}},s}();return{create:function(t){return new r(t)},register:function(e,a){t.plugins[e]=a}}},t.exports?t.exports=n():i.h337=n()},52:function(t,e,a){t.exports=a(70)},57:function(t,e,a){},64:function(t,e,a){},70:function(t,e,a){"use strict";a.r(e);var i,n=a(0),r=a.n(n),s=a(6),o=a.n(s),h=(a(57),a(46)),l=a(38),d=a(14),c=a(3),u=a(103),m=a(20),_=a(114),g=a(107),f=a(108),p=a(111),v=a(105),w=a(32),x=a(110),y=a(109),b=a(43),D=a.n(b),E=a(45),C=a.n(E),O=a(44),S=a.n(O),B=a(115),M=a(112),R=a(113),j=a(34),F=a.n(j),I=a(35),k=a.n(I),A=a(39),z=a.n(A),T=a(40),G=a.n(T),N=a(41),V=a.n(N);function P(t,e){this._viewer=t,this.initialize(e||{})}P.CSS_TRANSFORM=function(){for(var t=document.createElement("div"),e=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],a=0;a<e.length;a++){var i=e[a];if(void 0!==t.style[i])return i}return e[0]}(),P.prototype.initialize=function(t){this.cfg=t;var e=this.container=document.createElement("div"),a=this.width=this._viewer.container.clientWidth,i=this.height=this._viewer.container.clientHeight;e.style.cssText="width:"+a+"px;height:"+i+"px;",this.data=[],this.max=1,t.container=e,this.onAdd()},P.prototype.setData=function(t){this.max=t.max;for(var e=(t=t.data).length,a=[];e--;){var i=t[e],n={};n.value=i.value,n.x=i.x,n.y=i.y,i.radius&&(n.radius=i.radius),a.push(n)}this.data=a,this.update()},P.prototype.update=function(){var t=this._viewer.viewport.getZoom(!0);if(0!=this.data.length){var e={max:this.max},a=[],i=this.data.length,n=0;for(this.cfg.valueField;i--;){var r=this.data[i],s=r.value;s>n&&(n=s);var o=this._viewer.viewport.imageToViewportCoordinates(r.x,r.y),h=this._viewer.viewport.pixelFromPoint(o,!0);if(!(h.x<=0||h.y<=0||h.x>=this._viewer.viewport.getContainerSize().x||h.y>=this._viewer.viewport.getContainerSize().y)){var l,d={x:Math.round(h.x),y:Math.round(h.y),value:s};l=r.radius?r.radius*t:(this.cfg.radius||20)*t,d.radius=l,a.push(d)}}this.cfg.useLocalExtrema&&(e.max=n),e.data=a,this.heatmap.setData(e)}},P.prototype.onAdd=function(){this._viewer.canvas.appendChild(this.container),this.changeHandler=this._viewer.addHandler("update-viewport",(function(t){t.userData.draw.call(t.userData)}),this),this.heatmap||(console.log("HeatmapOverlay",this.cfg),this.heatmap=V.a.create(this.cfg)),this.draw()},P.prototype.draw=function(){this._viewer&&this.update()};var L=function(){var t=new z.a,e=new P(i,{backgroundColor:"rgba(0,0,0,0)",maxOpacity:.5,minOpacity:.05}),a=[],n=0;t.load("/Tumor_047.npy",(function(t){console.log("numpy array",t);var i=t.shape;t.data.map((function(t,e){if(0!==t){n=Math.max(n,100*t);var r={x:e%i[0]*64-32,y:64*Math.floor(e/i[0])-32,value:100*t,radius:64};a.push(r)}})),console.log("points",a);var r={max:n,data:a};e.setData(r)}))},W=function(){return r.a.useEffect((function(){(i=G()({id:"seadragon-viewer",debugMode:!1,visibilityRatio:1,constrainDuringPan:!0,showNavigator:!0,zoomPerScroll:1.8,showRotationControl:!0})).addTiledImage({tileSource:"/tumor_047.dzi",x:0,y:0,success:L})}),[]),r.a.createElement("div",{id:"seadragon-viewer",style:{height:"90vh",width:"100%"}})},H=(a(64),Object(u.a)((function(t){return{root:{display:"flex"},appBar:{zIndex:t.zIndex.drawer+1,transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})},appBarShift:{marginLeft:240,width:"calc(100% - ".concat(240,"px)"),transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:240,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:240,transition:t.transitions.create("width",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.enteringScreen})},drawerClose:Object(d.a)({transition:t.transitions.create("width",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),overflowX:"hidden",width:t.spacing(7)+1},t.breakpoints.up("sm"),{width:t.spacing(9)+1}),toolbar:Object(l.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:t.spacing(0,1)},t.mixins.toolbar),content:{flexGrow:1,padding:0}}}))),U=function(){var t,e,a=H(),i=Object(m.a)(),n=r.a.useState(!1),s=Object(h.a)(n,2),o=s[0],l=s[1];return r.a.createElement("div",{className:a.root},r.a.createElement(v.a,null),r.a.createElement(g.a,{position:"fixed",className:Object(c.a)(a.appBar,Object(d.a)({},a.appBarShift,o))},r.a.createElement(f.a,null,r.a.createElement(y.a,{color:"inherit","aria-label":"open drawer",onClick:function(){l(!0)},edge:"start",className:Object(c.a)(a.menuButton,Object(d.a)({},a.hide,o))},r.a.createElement(D.a,null)),r.a.createElement(w.a,{variant:"h6",noWrap:!0},"Pathology Viewer"))),r.a.createElement(_.a,{variant:"permanent",className:Object(c.a)(a.drawer,(t={},Object(d.a)(t,a.drawerOpen,o),Object(d.a)(t,a.drawerClose,!o),t)),classes:{paper:Object(c.a)((e={},Object(d.a)(e,a.drawerOpen,o),Object(d.a)(e,a.drawerClose,!o),e))}},r.a.createElement("div",{className:a.toolbar},r.a.createElement(y.a,{onClick:function(){l(!1)}},"rtl"===i.direction?r.a.createElement(S.a,null):r.a.createElement(C.a,null))),r.a.createElement(x.a,null),r.a.createElement(p.a,null,["Inbox","Starred","Send email","Drafts"].map((function(t,e){return r.a.createElement(B.a,{button:!0,key:t},r.a.createElement(M.a,null,e%2===0?r.a.createElement(F.a,null):r.a.createElement(k.a,null)),r.a.createElement(R.a,{primary:t}))}))),r.a.createElement(x.a,null),r.a.createElement(p.a,null,["All mail","Trash","Spam"].map((function(t,e){return r.a.createElement(B.a,{button:!0,key:t},r.a.createElement(M.a,null,e%2===0?r.a.createElement(F.a,null):r.a.createElement(k.a,null)),r.a.createElement(R.a,{primary:t}))})))),r.a.createElement("main",{className:a.content},r.a.createElement("div",{className:a.toolbar}),r.a.createElement(W,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[52,1,2]]]);
//# sourceMappingURL=main.8d103ced.chunk.js.map